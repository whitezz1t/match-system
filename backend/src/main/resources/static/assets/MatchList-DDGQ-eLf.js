import{A as e,D as t,E as n,F as r,I as i,L as a,M as o,N as s,P as c,S as l,T as u,V as d,_ as f,a as p,g as m,i as h,j as g,k as _,l as v,m as y,n as b,t as x,w as S,x as C,y as w,z as T}from"./index-BJes4zwE.js";import{t as E}from"./axios-CseGY6Es.js";var D={class:`header-row`},O={class:`filter-row`,style:{"margin-top":`20px`,display:`flex`,gap:`15px`,"flex-wrap":`wrap`,"align-items":`center`}},k={style:{"font-weight":`bold`}},A={style:{"font-weight":`bold`}},j={style:{"font-size":`16px`,"font-weight":`bold`,color:`#409EFF`}},M=f({__name:`MatchList`,setup(d){let f=m(),M=i([]),N=i([]),P=i(!1),F=i(!1),I=r({dateRange:null,level:``,playerId:null}),L=r({level:`å°ç»„èµ›`,playerAId:null,playerBId:null}),R=async()=>{P.value=!0;try{let e={};I.level&&(e.level=I.level),I.playerId&&(e.playerId=I.playerId),I.dateRange&&I.dateRange.length===2&&(e.startDate=I.dateRange[0],e.endDate=I.dateRange[1]);let[t,n]=await Promise.all([E.get(`/api/matches`,{params:e}),E.get(`/api/players`)]);M.value=t.data||[],N.value=n.data||[]}catch{b.error(`æ•°æ®åŠ è½½å¤±è´¥`),M.value=[]}finally{P.value=!1}},z=()=>{I.dateRange=null,I.level=``,I.playerId=null,R()},B=async()=>{if(!L.playerAId||!L.playerBId){b.warning(`è¯·é€‰æ‹©ä¸¤åé€‰æ‰‹`);return}if(L.playerAId===L.playerBId){b.warning(`ä¸èƒ½é€‰æ‹©åŒä¸€åé€‰æ‰‹`);return}try{let e=await E.post(`/api/matches/start`,null,{params:{playerAId:L.playerAId,playerBId:L.playerBId,level:L.level}});b.success(`æ¯”èµ›åˆ›å»ºæˆåŠŸï¼`),F.value=!1,R(),V(e.data.matchId)}catch{b.error(`åˆ›å»ºå¤±è´¥`)}},V=e=>{f.push({path:`/menu/scoreboard`,query:{id:e}})},H=async e=>{try{b.info(`æ­£åœ¨ç”Ÿæˆ Excelï¼Œè¯·ç¨å€™...`);let t=await E.get(`/api/matches/${e}/export`,{responseType:`blob`}),n=new Blob([t.data],{type:`application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`}),r=document.createElement(`a`);r.href=window.URL.createObjectURL(n),r.download=`æ¯”èµ›è®°å½•_${e}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(r.href),b.success(`å¯¼å‡ºæˆåŠŸï¼`)}catch{b.error(`å¯¼å‡ºå¤±è´¥`)}},U=e=>{x.confirm(`åˆ é™¤åŽæ— æ³•æ¢å¤ï¼Œç¡®å®šè¦åˆ é™¤è¿™åœºæ¯”èµ›åŠå…¶æ‰€æœ‰å›žåˆè®°å½•å—ï¼Ÿ`,`è­¦å‘Š`,{confirmButtonText:`ç¡®å®šåˆ é™¤`,cancelButtonText:`å–æ¶ˆ`,type:`warning`}).then(async()=>{try{await E.delete(`/api/matches/${e}`),b.success(`åˆ é™¤æˆåŠŸ`),R()}catch{b.error(`åˆ é™¤å¤±è´¥`)}}).catch(()=>{})};return t(()=>{R()}),(t,r)=>{let i=g(`el-icon`),d=g(`el-button`),f=g(`el-date-picker`),m=g(`el-option`),b=g(`el-select`),x=g(`el-card`),E=g(`el-table-column`),W=g(`el-tag`),G=g(`el-table`),K=g(`el-form-item`),q=g(`el-form`),J=g(`el-dialog`),Y=o(`loading`);return _(),S(`div`,null,[n(x,{shadow:`never`,style:{"margin-bottom":`20px`}},{default:s(()=>[C(`div`,D,[r[10]||=C(`span`,{style:{"font-weight":`bold`,"font-size":`16px`}},`ðŸ“… æ¯”èµ›åŽ†å²è®°å½•`,-1),n(d,{type:`success`,onClick:r[0]||=e=>F.value=!0},{default:s(()=>[n(i,{style:{"margin-right":`5px`}},{default:s(()=>[n(a(y))]),_:1}),r[9]||=u(`å¼€å§‹æ–°æ¯”èµ› `,-1)]),_:1})]),C(`div`,O,[n(f,{modelValue:I.dateRange,"onUpdate:modelValue":r[1]||=e=>I.dateRange=e,type:`daterange`,"range-separator":`è‡³`,"start-placeholder":`å¼€å§‹æ—¥æœŸ`,"end-placeholder":`ç»“æŸæ—¥æœŸ`,format:`YYYY-MM-DD`,"value-format":`YYYY-MM-DD`,style:{width:`300px`}},null,8,[`modelValue`]),n(b,{modelValue:I.level,"onUpdate:modelValue":r[2]||=e=>I.level=e,placeholder:`æ¯”èµ›çº§åˆ«`,clearable:``,style:{width:`150px`}},{default:s(()=>[n(m,{label:`å†³èµ›`,value:`å†³èµ›`}),n(m,{label:`åŠå†³èµ›`,value:`åŠå†³èµ›`}),n(m,{label:`å°ç»„èµ›`,value:`å°ç»„èµ›`})]),_:1},8,[`modelValue`]),n(b,{modelValue:I.playerId,"onUpdate:modelValue":r[3]||=e=>I.playerId=e,placeholder:`åŒ…å«é€‰æ‰‹`,clearable:``,filterable:``,style:{width:`150px`}},{default:s(()=>[(_(!0),S(w,null,e(N.value,e=>(_(),l(m,{key:e.playerId,label:e.name,value:e.playerId},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`]),n(d,{type:`primary`,onClick:R},{default:s(()=>[n(i,{style:{"margin-right":`5px`}},{default:s(()=>[n(a(v))]),_:1}),r[11]||=u(` æœç´¢ `,-1)]),_:1}),n(d,{onClick:z},{default:s(()=>[...r[12]||=[u(`é‡ç½®`,-1)]]),_:1})])]),_:1}),c((_(),l(G,{data:M.value,border:``,stripe:``,style:{width:`100%`}},{default:s(()=>[n(E,{prop:`matchId`,label:`ID`,width:`80`,align:`center`}),n(E,{prop:`matchDate`,label:`æ¯”èµ›æ—¶é—´`,width:`180`,align:`center`},{default:s(e=>[u(T(e.row.matchDate?new Date(e.row.matchDate).toLocaleString():`æ— æ—¶é—´`),1)]),_:1}),n(E,{prop:`level`,label:`çº§åˆ«`,width:`100`,align:`center`},{default:s(e=>[n(W,{type:`warning`,size:`small`},{default:s(()=>[u(T(e.row.level||`æ™®é€šèµ›`),1)]),_:2},1024)]),_:1}),n(E,{label:`å¯¹é˜µåŒæ–¹`,align:`center`},{default:s(e=>[C(`span`,k,T(e.row.playerAName),1),r[13]||=C(`span`,{style:{margin:`0 10px`,color:`#909399`}},`VS`,-1),C(`span`,A,T(e.row.playerBName),1)]),_:1}),n(E,{label:`å½“å‰æ¯”åˆ†`,width:`120`,align:`center`},{default:s(e=>[C(`span`,j,T(e.row.finalScoreA)+` : `+T(e.row.finalScoreB),1)]),_:1}),n(E,{prop:`status`,label:`çŠ¶æ€`,width:`100`,align:`center`},{default:s(e=>[n(W,{type:e.row.status===`ONGOING`?`success`:`info`},{default:s(()=>[u(T(e.row.status===`ONGOING`?`è¿›è¡Œä¸­`:`å·²ç»“æŸ`),1)]),_:2},1032,[`type`])]),_:1}),n(E,{label:`æ“ä½œ`,width:`280`,align:`center`},{default:s(e=>[n(d,{type:`primary`,size:`small`,onClick:t=>V(e.row.matchId)},{default:s(()=>[...r[14]||=[u(` è¯¦æƒ… `,-1)]]),_:1},8,[`onClick`]),n(d,{type:`success`,size:`small`,onClick:t=>H(e.row.matchId)},{default:s(()=>[n(i,null,{default:s(()=>[n(a(p))]),_:1})]),_:1},8,[`onClick`]),n(d,{type:`danger`,size:`small`,onClick:t=>U(e.row.matchId)},{default:s(()=>[n(i,null,{default:s(()=>[n(a(h))]),_:1}),r[15]||=u(` åˆ é™¤ `,-1)]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])),[[Y,P.value]]),n(J,{modelValue:F.value,"onUpdate:modelValue":r[8]||=e=>F.value=e,title:`å‘èµ·æ–°æ¯”èµ›`,width:`500px`},{footer:s(()=>[n(d,{onClick:r[7]||=e=>F.value=!1},{default:s(()=>[...r[16]||=[u(`å–æ¶ˆ`,-1)]]),_:1}),n(d,{type:`primary`,onClick:B},{default:s(()=>[...r[17]||=[u(`ç¡®å®šå¼€å§‹`,-1)]]),_:1})]),default:s(()=>[n(q,{model:L,"label-width":`80px`},{default:s(()=>[n(K,{label:`æ¯”èµ›çº§åˆ«`},{default:s(()=>[n(b,{modelValue:L.level,"onUpdate:modelValue":r[4]||=e=>L.level=e,placeholder:`è¯·é€‰æ‹©çº§åˆ«`},{default:s(()=>[n(m,{label:`å†³èµ›`,value:`å†³èµ›`}),n(m,{label:`åŠå†³èµ›`,value:`åŠå†³èµ›`}),n(m,{label:`å°ç»„èµ›`,value:`å°ç»„èµ›`})]),_:1},8,[`modelValue`])]),_:1}),n(K,{label:`é€‰æ‰‹A`},{default:s(()=>[n(b,{modelValue:L.playerAId,"onUpdate:modelValue":r[5]||=e=>L.playerAId=e,placeholder:`é€‰æ‹©é€‰æ‰‹A`},{default:s(()=>[(_(!0),S(w,null,e(N.value,e=>(_(),l(m,{key:e.playerId,label:e.name,value:e.playerId},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`])]),_:1}),n(K,{label:`é€‰æ‰‹B`},{default:s(()=>[n(b,{modelValue:L.playerBId,"onUpdate:modelValue":r[6]||=e=>L.playerBId=e,placeholder:`é€‰æ‹©é€‰æ‰‹B`},{default:s(()=>[(_(!0),S(w,null,e(N.value,e=>(_(),l(m,{key:e.playerId,label:e.name,value:e.playerId},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`])]),_:1})]),_:1},8,[`model`])]),_:1},8,[`modelValue`])])}}},[[`__scopeId`,`data-v-6daadd83`]]);export{M as default};